{% extends "base.html" %}

{% block title %}Home - E-Commerce Site{% endblock %}

{% block content %}
<h1>Welcome to ZoomZing</h1>
<div class="product-grid">
    <div class="product-card" data-product-id="1" data-name="Luxury Watch" data-price="99.99">
        <img src="{{ url_for('static', filename='images/lux_watch.png') }}" alt="Luxury Watch" class="product-image">
        <h3>Luxury Watch</h3>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
        <p class="price">$99.99</p>
    </div>
    <div class="product-card" data-product-id="2" data-name="Designer Jeans" data-price="79.99">
        <img src="{{ url_for('static', filename='images/jeans.png') }}" alt="Designer Jeans" class="product-image">
        <h3>Designer Jeans</h3>
        <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        <p class="price">$79.99</p>
    </div>
    <div class="product-card" data-product-id="3" data-name="Casual Shirt" data-price="129.99">
        <img src="{{ url_for('static', filename='images/shirt.png') }}" alt="Casual Shirt" class="product-image">
        <h3>Casual Shirt</h3>
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
        <p class="price">$129.99</p>
    </div>
</div>

<!-- Product Modal -->
<div id="productModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div class="modal-product-details">
            <img id="modalProductImage" src="" alt="" class="modal-product-image">
            <div class="modal-product-info">
                <h2 id="modalProductName"></h2>
                <p id="modalProductDescription"></p>
                <p class="modal-price">$<span id="modalProductPrice"></span></p>
                <button class="add-to-cart-btn">Add to Cart</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Get modal elements
    const modal = document.getElementById('productModal');
    const modalImage = document.getElementById('modalProductImage');
    const modalName = document.getElementById('modalProductName');
    const modalDescription = document.getElementById('modalProductDescription');
    const modalPrice = document.getElementById('modalProductPrice');
    const closeBtn = document.querySelector('.close');
    let currentProduct = null;

    // Add click event to all product cards
    document.querySelectorAll('.product-card').forEach(card => {
        card.addEventListener('click', () => {
            currentProduct = {
                id: card.dataset.productId,
                name: card.dataset.name,
                price: card.dataset.price,
                image: card.querySelector('img').src,
                description: card.querySelector('p').textContent
            };
            
            modalImage.src = currentProduct.image;
            modalImage.alt = currentProduct.name;
            modalName.textContent = currentProduct.name;
            modalDescription.textContent = currentProduct.description;
            modalPrice.textContent = currentProduct.price;
            modal.style.display = 'block';
        });
    });

    // Close modal when clicking (x)
    closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
    });

    // Close modal when clicking outside
    window.addEventListener('click', (e) => {
        if (e.target == modal) {
            modal.style.display = 'none';
        }
    });

    // Add to cart functionality
    document.querySelector('.add-to-cart-btn').addEventListener('click', () => {
        if (currentProduct) {
            fetch('/cart/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(currentProduct)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    updateCartCount(data.cart_count);
                    modal.style.display = 'none';
                }
            });
        }
    });
</script>
{% endblock %}